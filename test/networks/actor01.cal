actor actor01() int data ==> int xml:

  uint(size=16) STREAM_MAGIC = 0xACED;
  uint(size=16) STREAM_VERSION = 5;

  read_magic: action data:[ high, low ] ==> xml: [ 34, 45, 56 ]
  guard
    bitor(lshift(high, 8), low) = STREAM_MAGIC
  end

  read_version: action data:[ high, low ] ==>
  guard
    bitor(lshift(high, 8), low) = STREAM_VERSION
  end
  
  error: action data:[ high, low ] ==>
  do
    println("error: read " + high + " " + low);
  end

  priority
    read_magic > error;
    read_version > error;
  end
  
  schedule fsm init :
    init (read_magic) --> version;
    init (error) --> error;
    
    version (read_version) --> contents;
    version (error) --> error;
    
    contents (block_data) --> contents;
    contents (object) --> contents;
  end

end
